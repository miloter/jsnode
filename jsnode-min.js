var $,$$;
/**
 * @summary JsNode es similar a un jQuery reducido usando solo ES6+ y
 * el sistema de Promises/async/await donde es necesario.
 * @copyright miloter
 * @license MIT
 * @since 2025-06-06 
 * @version 0.6.0 2025-06-23
 */class JsNode{static#e=["domingo","lunes","martes","miércoles","jueves","viernes","sábado"];static#t=JsNode.#e.map((e=>e.substring(0,3)));static#s=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];static#i=JsNode.#s.map((e=>e.substring(0,3)));static#o=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","CANVAS","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HR","LI","MAIN","NAV","NOSCRIPT","OL","P","PRE","SECTION","TABLE","TFOOT","UL","VIDEO"];static#n=60;static#a=[];static#r=!1;#d;constructor(e){try{if("string"==typeof e)this.#d=Array.from(document.querySelectorAll(e));else if(e instanceof HTMLElement)this.#d=[e];else if(e instanceof NodeList)this.#d=Array.from(e);else if(e instanceof Array)this.#d=e;else if(e instanceof JsNode)this.#d=e.nodes;else{if(void 0!==e)throw new TypeError(`Selector no válido: ${e}`);this.#d=[]}}catch(e){this.#d=[]}}static#l(e,t){if(!e.listeners)return;const s=e.listeners[t];if(s){for(const i of s)e.removeEventListener(t,i);delete e.listeners[t]}}static#h(e){if(e.listeners)for(const t in e.listeners)JsNode.#l(e,t)}static#c(e){e.displayComputed&&delete e.displayComputed,e.visibilityComputed&&delete e.visibilityComputed}static#p(e,t,s){null===s?e.removeAttribute(t):e.setAttribute(t,s)}static async#u(e,t){const s={};return s.response=e,s.data="json"===t?await e.json():"text"===t?await e.text():await e.blob(),s}static async#m(e,t,s,i){let o,n;return"json"===(i=i.toLowerCase())?(o={"Content-Type":"application/json"},n=JSON.stringify(s)):(o={"Content-Type":"application/x-www-form-urlencoded"},n=JsNode.objectToUrlEncoded(s)),fetch(e,{credentials:"include",headers:o,method:t,body:n}).then((e=>JsNode.#u(e,i)))}static async#f(e,t,s,i){return i=i.toLowerCase(),(s=JsNode.objectToUrlEncoded(s))&&(e+="?"+s),fetch(e,{credentials:"include",method:t}).then((e=>JsNode.#u(e,i)))}static#y(e=1){return JsNode.#r?Promise.resolve():new Promise((t=>setTimeout(t,e)))}static#b(e){const{display:t,width:s,height:i,opacity:o,overflow:n,visibility:a}=getComputedStyle(e);return{display:t,width:s,height:i,opacity:o,overflow:n,visibility:a}}static async#g(e,t,s){const i=t/JsNode.#n,o=JsNode.#N(e);let n,a,r,d,l,h;for("inline"===o.display&&(s="opacity"),"opacity"!==s&&(n="all"===s||"width"===s?0:parseFloat(o.width),a="all"===s||"height"===s?0:parseFloat(o.height),d=parseFloat(o.width)/JsNode.#n,l=parseFloat(o.height)/JsNode.#n,e.style.width=n+"px",e.style.height=a+"px"),r="all"===s||"opacity"===s?0:o.opacity,h=o.opacity/JsNode.#n,e.style.opacity=r,e.style.display=o.display,e.style.overflow="hidden","hidden"!==o.visibility&&"collapse"!==o.visibility||(e.style.visibilityComputed=o.visibility,o.visibility="visible",e.style.visibility="visible");t>0&&("all"!==s&&"width"!==s||(n+=d,e.style.width=n+"px"),"all"!==s&&"height"!==s||(a+=l,e.style.height=a+"px"),"all"!==s&&"opacity"!==s||(r+=h,e.style.opacity=r),await JsNode.#y(i),!JsNode.#r);)t-=i;Object.assign(e.style,o)}static async#v(e,t,s){const i=t/JsNode.#n,o=JsNode.#N(e);let n,a,r,d,l,h;for("inline"===o.display&&(s="opacity"),"inline"!==o.display&&"opacity"!==s&&(n=parseFloat(o.width),a=parseFloat(o.height),d=n/JsNode.#n,l=a/JsNode.#n),r=o.opacity,h=r/JsNode.#n,e.style.overflow="hidden";t>0&&("all"!==s&&"width"!==s||(n-=d,e.style.width=n+"px"),"all"!==s&&"height"!==s||(a-=l,e.style.height=a+"px"),"all"!==s&&"opacity"!==s||(r-=h,e.style.opacity=r),await JsNode.#y(i),!JsNode.#r);)t-=i;Object.assign(e.style,o),JsNode.#w(e,!1,s,!0)}static#J(e,t,s){return function(){e.apply(t,s)}}static#w(e,t,s,i=!1){const o=getComputedStyle(e);t?("hidden"!==o.visibility&&"collapse"!==o.visibility||(e.style.visibilityComputed=o.visibility,e.style.visibility="visible"),e.style.display=e.style.displayComputed||JsNode.#E(e.tagName)):(e.style.displayComputed=o.display,"opacity"===s||!i&&e.style.visibilityComputed?e.style.visibility=e.style.visibilityComputed??"hidden":e.style.display="none")}static#N(e){let t=JsNode.#b(e);if("none"===t.display||"auto"===t.width||"auto"===t.height||"0px"===t.width||"0px"===t.height){const s=e.style.display;"none"===t.display&&e.style.displayComputed&&(t.display=e.style.displayComputed),e.style.display="none"!==t.display?t.display:JsNode.#E(e.tagName),t=JsNode.#b(e),e.style.display=s}return t}static#E(e){return JsNode.#o.includes(e)?"block":"TR"===e?"table-row":"TH"===e||"TD"===e?"table-cell":"THEAD"===e?"table-header-group":"TBODY"===e?"table-row-group":"TFOOT"===e?"table-footer-group":"inline"}static use$(){return $=JsNode.select,$$=JsNode,JsNode}static domLoaded(){return new Promise(((e,t)=>{try{"complete"===document.readyState||"interactive"===document.readyState?e():document.addEventListener("DOMContentLoaded",(()=>e()))}catch(e){t(e)}}))}static loadLibs(e){return new Promise(((s,i)=>{try{"complete"===document.readyState||"interactive"===document.readyState?s(t(e)):document.addEventListener("DOMContentLoaded",(()=>s(t(e))))}catch(e){i(e)}}));async function t(e){"string"!=typeof e&&"object"!=typeof e||(e=[e]);for(let t of e){let e;const i=typeof t;try{e="string"===i?await s(t):"object"===i&&await s(t.path,t.endBody,t.type,t.noExtension)}catch{throw new Error(`No se pudo cargar: '${"string"===i?t:t.path}'`)}}return!0}function s(e,t,s,i){return new Promise(((o,n)=>{let a,r;if(e.toLowerCase().endsWith(".js")?(a=document.createElement("script"),a.src=e,r="js"):e.toLowerCase().endsWith(".css")?(a=document.createElement("link"),a.href=e,a.rel="stylesheet",r="css"):i&&(a=document.createElement("script"),a.src=e,r="noExtension"),!r)return n(!1);s&&"string"==typeof s&&(a.type=s),a.onload=function(e){o(!0)},a.onerror=function(e){n(!1)};try{t?document.body.append(a):document.head.append(a)}catch{n(!1)}}))}}static select(e){return new JsNode(e)}static dateParts(e){const t={},s=(e=void 0!==e?new Date(e):new Date).getDay();e.setMinutes(e.getMinutes()-e.getTimezoneOffset());const i=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d).(\d{3})Z$/.exec(e.toISOString());i.push(s,JsNode.#e[s],JsNode.#s[t.mon-1]),["year","mon","mday","hours","minutes","seconds","milliseconds"].forEach(((e,s)=>t[e]=parseInt(i[s+1]))),t.weekday=JsNode.#e[s],t.wday=0===s?7:s,t.month=JsNode.#s[t.mon-1];const o=new Date(e.getFullYear(),0,1);return t.yday=Math.ceil((e-o+1)/864e5),t.epoch=e.getTime(),t.offset=e.getTimezoneOffset(),t}static dateFormat(e="d/m/Y H:i:s:u",t){const s=JsNode.dateParts(t),i=[];function o(e,t=2){const o=s[e].toString();t>=0?i.push(o.padStart(t,"0")):i.push(o)}let n=!1;for(const t of e)if(n)i.push(t),n=!1;else switch(t){case"D":i.push(s.weekday.substring(0,3));break;case"F":o("month");break;case"G":o("hours",-1);break;case"H":o("hours");break;case"L":i.push(JsNode.isLeapYear(s.year)?"1":"0");break;case"M":i.push(s.month.substring(0,3));break;case"U":o("epoch",-1);break;case"Y":o("year",4);break;case"Z":o("offset",-1);break;case"d":o("mday");break;case"i":o("minutes");break;case"j":o("mday",-1);break;case"l":o("weekday");break;case"m":o("mon");break;case"n":o("mon",-1);break;case"s":o("seconds");break;case"t":let e;e=[1,3,5,7,8,10,12].includes(s.mon)?"31":[4,6,9,11].includes(s.mon)?"30":JsNode.isLeapYear(s.year)?"29":"28",i.push(e);break;case"u":o("milliseconds",3);break;case"w":o("wday",1);break;case"y":i.push(s.year.toString().padStart(4,"0").substring(2));break;case"z":o("yday",-1);break;case"\\":n=!0;break;default:i.push(t)}return i.join("")}static dateParse(e="d/m/Y",t="01/01/1970"){const s=["^"],i=[];let o=!1;for(const t of e)if(o)s.push(("\\"===t?t:"")+t),o=!1;else switch(t){case"D":s.push(`(${JsNode.#t.join("|")})`),i.push(t);break;case"F":s.push(`(${JsNode.#s.join("|")})`),i.push(t);break;case"G":s.push("(\\d{1,2})"),i.push(t);break;case"H":s.push("(\\d{2})"),i.push(t);break;case"L":s.push("([01])"),i.push(t);break;case"M":s.push(`(${JsNode.#i.join("|")})`),i.push(t);break;case"U":s.push("(-?\\d{1,16})"),i.push(t);break;case"Y":s.push("(\\d{4})"),i.push(t);break;case"Z":s.push("(-?\\d{1,3})"),i.push(t);break;case"d":s.push("(\\d{2})"),i.push(t);break;case"i":s.push("(\\d{2})"),i.push(t);break;case"j":s.push("(\\d{1,2})"),i.push(t);break;case"l":s.push(`(${JsNode.#e.join("|")})`),i.push(t);break;case"m":s.push("(\\d{2})"),i.push(t);break;case"n":s.push("(\\d{1,2})"),i.push(t);break;case"s":s.push("(\\d{2})"),i.push(t);break;case"t":s.push("(\\d{2})"),i.push(t);break;case"u":s.push("(\\d{3})"),i.push(t);break;case"w":s.push("([1-7])"),i.push(t);break;case"y":s.push("(\\d{2})"),i.push(t);break;case"z":s.push("(\\d{1,3})"),i.push(t);break;case"\\":o=!0;break;default:const e=["^","$","|",".","?","*","+","(",")","[","]","{","}"].includes(t);s.push((e?"\\":"")+t)}s.push("$");const n=t.match(s.join("")),a={};if(n){for(let e=0;e<i.length;e++)a[i[e]]=n[e+1];let e,t=0,s=1,o=0,r=0,d=0,l=0;return a.Y?e=a.Y:a.y&&(e=(new Date).getFullYear().toString().padStart(4,"0").substring(0,2)+a.y),a.m?t=parseInt(a.m)-1:a.n?t=parseInt(a.n)-1:a.F?t=JsNode.#s.indexOf(a.F):a.M&&(t=JsNode.#i.indexOf(a.M)),a.d?s=a.d:a.j&&(s=a.j),a.H?o=a.H:a.G&&(o=a.G),a.i&&(r=a.i),a.s&&(d=a.s),a.u&&(l=a.u),void 0!==e?new Date(e,t,s,o,r,d,l):a.U?new Date(parseInt(a.U)):NaN}return NaN}static isLeapYear(e){return e%4==0&&e%100!=0||e%400==0}static objectToUrlEncoded(e){let t="";for(let s in e)t&&(t+="&"),t+=s+"="+encodeURIComponent(e[s]);return t}static async post(e,t={},s="text"){return JsNode.#m(e,"POST",t,s)}static async put(e,t={},s="text"){return JsNode.#m(e,"PUT",t,s)}static async get(e,t={},s="text"){return JsNode.#f(e,"GET",t,s)}static async delete(e,t={},s="text"){return JsNode.#f(e,"DELETE",t,s)}static strToB64(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,((e,t)=>String.fromCharCode(parseInt(t,16)))))}static b64ToStr(e){const t=atob(e),s=t.length,i=new Uint8Array(s);for(let e=0;e<s;e++)i[e]=t.charCodeAt(e);return(new TextDecoder).decode(i)}static fileToDataUrl(e){return new Promise(((t,s)=>{try{const s=new FileReader;s.addEventListener("load",(e=>t(e.target.result))),s.readAsDataURL(e)}catch(e){s(e)}}))}static b64ToUint8(e){const t=atob(e),s=t.length,i=new Uint8Array(s);for(let e=0;e<s;e++)i[e]=t.charCodeAt(e);return i}static strToUint8(e){return(new TextEncoder).encode(e)}static uInt8ToStr(e){return(new TextDecoder).decode(e)}static blobToUint8(e){return new Promise((async(t,s)=>{try{t(new Uint8Array(await e.arrayBuffer()))}catch(e){s(e)}}))}static uInt8ToBlob(e,t){return new Blob([e],{type:t})}static blobToFile(e,t){return new File([e],t,{type:e.type})}static fileToBlob(e){return new Promise((async(t,s)=>{try{const s=await e.arrayBuffer();t(new Blob([new Uint8Array(s)],{type:e.type}))}catch(e){s(e)}}))}static isNumber(e){return isFinite(Number(e))}static isInteger(e){return JsNode.isNumber(e)&&e==Math.floor(e)}static randInt(e,t){return Math.floor((t-e+1)*Math.random()+1*e)}static randDec(e,t){return(t-e)*Math.random()+1*e}static round(e,t=0){const s=Math.pow(10,t);return Math.round(e*s)/s}static setCookie(e,t,s,i,o,n){let a=e+"="+encodeURIComponent(t);void 0!==s&&(a+="; expires="+s.toGMTString()),void 0!==i&&(a+="; domain="+i),void 0!==o&&(a+="; path="+o),void 0!==n&&n&&(a+="; secure"),document.cookie=a}static getCookie(e){if(0!=document.cookie.length){let t=document.cookie.indexOf(e+"=");if(t>=0){t+=e.length+1;let s=document.cookie.indexOf(";",t);return s=s>=0?s:document.cookie.length,decodeURIComponent(document.cookie.substring(t,s))}}}static getTypeName(e){return/^\[object (\w+)\]$/.exec(Object.prototype.toString.call(e))[1]}static get qsMap(){const e={},t=decodeURIComponent(location.search.substring(1).replace(/\+/g," "));if(t){const s=t.split("&");for(let t=0;t<s.length;t++)e[s[t].substring(0,s[t].indexOf("="))]=s[t].substring(s[t].indexOf("=")+1)}return e}static stop(){JsNode.#r||(JsNode.#a=[],JsNode.#r=!0)}#A(){this.#d.forEach((e=>{if(e.style.displayComputed||e.style.visibilityComputed){const t=getComputedStyle(e);e.style.displayComputed&&"none"!==t.display&&t.display!==e.style.displayComputed&&(e.style.displayComputed=t.display),e.style.visibilityComputed&&t.visibility!==e.style.visibilityComputed&&("visible"===t.visibility?delete e.style.visibilityComputed:e.style.visibilityComputed=t.visibility)}}))}#C(e,t){this.#d.forEach((e=>delete e.isAnimating)),JsNode.#a.length&&setTimeout(JsNode.#a.shift()),JsNode.#r?JsNode.#r=!1:"function"==typeof e&&e.call(this),t()}css(e,t){return void 0!==t?(this.#d.forEach((s=>{s.style[e]=t})),this.#A(),this):"object"==typeof e?(this.#d.forEach((t=>{for(const s in e)t.style[s]=e[s]})),this.#A(),this):void 0===e?(this.#d.forEach((e=>{for(;e.style[0];)e.style[e.style[0]]="";this.#A()})),this):this.#d[0]?.style[e]}filterText(e,t=!1,s=!1){return t&&(e=e.normalize("NFD").toLowerCase().replace(/[\u0300-\u036f]/g,"")),this.#d=this.#d.filter((i=>{let o;return o=t?i.innerText.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().indexOf(e)>=0:i.innerText.indexOf(e)>=0,s?!o:o})),this}filterRegExp(e,t="",s){const i=new RegExp(e,t);return this.#d=this.#d.filter(((e,t)=>{let o;return"function"==typeof s?(o=i.exec(e.innerText),o&&(o=s.call(new JsNode(e),o,t)),o=!!o):o=i.test(e.innerText),o})),this}select(e){let t=[];for(const s of this.#d){const i=Array.from(s.querySelectorAll(e));t=t.concat(i)}return new JsNode(t)}each(e){return this.#d.forEach(((t,s)=>e.call(new JsNode(t),s))),this}filter(e){return this.#d=this.#d.filter(((t,s)=>{let i;return i="function"==typeof e?!!e.call(new JsNode(t),s):t.matches(e),i})),this}slice(e=0,t){return this.#d=this.#d.slice(e,t),this}text(e){if(void 0===e){let e="";for(const t of this.#d)e+=t.textContent;return e}return this.empty(),this.#d.forEach(((t,s)=>{t.textContent="function"!=typeof e?e:e(t.textContent,s)})),this}html(e){return void 0===e?this.#d[0]?.innerHTML:(this.empty(),this.#d.forEach(((t,s)=>{t.innerHTML="function"!=typeof e?e:e(t.innerHTML,s)})),this)}val(e){return void 0===e?this.#d[0]?.value:(this.#d.forEach(((t,s)=>{t.value="function"!=typeof e?e:e(t.value,s)})),this)}attr(e,t){return void 0!==t?(this.#d.forEach(((s,i)=>{"function"!=typeof t?JsNode.#p(s,e,t):JsNode.#p(s,e,t(s.getAttribute(e),i))})),this):"object"==typeof e?(this.#d.forEach((t=>{for(const s in e)JsNode.#p(t,s,e[s])})),this):this.#d[0]?.getAttribute(e)}prop(e,t){return void 0!==t?(this.#d.forEach(((s,i)=>{s[e]="function"!=typeof t?t:t(s[e],i)})),this):"object"==typeof e?(this.#d.forEach((t=>{for(const s in e)t[s]=e[s]})),this):this.#d[0]?.[e]}after(e){for(const t of this.#d)"string"==typeof e?t.insertAdjacentHTML("afterend",e):e instanceof HTMLElement?t.insertAdjacentElement("afterend",e):e instanceof NodeList||e instanceof Array?e.forEach((e=>t.insertAdjacentElement("afterend",e))):e instanceof JsNode&&e.nodes.forEach((e=>t.insertAdjacentElement("afterend",e)));return this}before(e){for(const t of this.#d)"string"==typeof e?t.insertAdjacentHTML("beforebegin",e):e instanceof HTMLElement?t.insertAdjacentElement("beforebegin",e):e instanceof NodeList||e instanceof Array?e.forEach((e=>t.insertAdjacentElement("beforebegin",e))):e instanceof JsNode&&e.nodes.forEach((e=>t.insertAdjacentElement("beforebegin",e)));return this}append(e){for(const t of this.#d)"string"==typeof e?t.insertAdjacentHTML("beforeend",e):e instanceof HTMLElement?t.insertAdjacentElement("beforeend",e):e instanceof NodeList||e instanceof Array?e.forEach((e=>t.insertAdjacentElement("beforeend",e))):e instanceof JsNode&&e.nodes.forEach((e=>t.insertAdjacentElement("beforeend",e)));return this}prepend(e){for(const t of this.#d)"string"==typeof e?t.insertAdjacentHTML("afterbegin",e):e instanceof HTMLElement?t.insertAdjacentElement("afterbegin",e):e instanceof NodeList||e instanceof Array?e.forEach((e=>t.insertAdjacentElement("afterbegin",e))):e instanceof JsNode&&e.nodes.forEach((e=>t.insertAdjacentElement("afterbegin",e)));return this}clone(){const e=[];for(const t of this.#d)e.push(t.cloneNode(!0));return new JsNode(e)}parent(e){const t=[];for(const s of this.#d){const i=s.parentElement;!i||t.includes(i)||void 0!==e&&!i.matches(e)||t.push(i)}return new JsNode(t)}parents(e,t){const s=[];for(const i of this.#d){let o=i.parentElement;for(;o&&(void 0===t||!o.matches(t));)s.includes(o)||void 0!==e&&!o.matches(e)||s.push(o),o=o.parentElement}return new JsNode(s)}parentsUntil(e){return this.parents(void 0,e)}children(e){const t=JsNode.isNumber(e);let s=[];for(const i of this.#d){const o=Array.from(i.children);let n;t&&(n=e<0?o.length+e:e);const a=o.filter(((s,i)=>void 0===e||(t?n==i:s.matches(e))));s=s.concat(a)}return new JsNode(s)}siblings(e,t=0,s){let i=[];for(const o of this.#d){let n;if(t<=0)for(n=o.previousElementSibling;n&&(void 0===e||n.matches(e))&&!i.includes(n)&&(void 0===s||!n.matches(s));)i.unshift(n),n=n.previousElementSibling;if(t>=0)for(n=o.nextElementSibling;n&&(void 0===e||n.matches(e))&&!i.includes(n)&&(void 0===s||!n.matches(s));)i.push(n),n=n.nextElementSibling}return new JsNode(i)}next(e){const t=[];for(const s of this.#d){const i=s.nextElementSibling;i&&(void 0===e||i.matches(e))&&t.push(i)}return new JsNode(t)}nextAll(e){return this.siblings(e,1)}nextUntil(e){return this.siblings(void 0,1,e)}prev(e){const t=[];for(const s of this.#d){const i=s.previousElementSibling;i&&(void 0===e||i.matches(e))&&t.push(s.previousElementSibling)}return new JsNode(t)}prevAll(e){return this.siblings(e,-1)}prevUntil(e){return this.siblings(void 0,-1,e)}addClass(e){const t=e.trim().split(/\s+/);return this.#d.forEach((e=>{t.forEach((t=>e.classList.add(t)))})),this.#A(),this}removeClass(e){const t=e.trim().split(/\s+/);return this.#d.forEach((e=>{t.forEach((t=>e.classList.remove(t)))})),this.#A(),this}toggleClass(e){const t=e.trim().split(/\s+/);return this.#d.forEach((e=>{t.forEach((t=>{e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)}))})),this.#A(),this}show(e,t=0,s="all",i){return void 0!==e?this.#d.some((e=>e.isAnimating))?JsNode.#a.push(JsNode.#J(this.show,this,[e,t,s,i])):new Promise((async o=>{s=s.toLowerCase(),this.#d.forEach(((e,t)=>{this.visible(t)||(e.isAnimating=!0)})),void 0!==t&&t>0&&await JsNode.#y(t);const n=[];this.#d.forEach(((t,i)=>{this.visible(i)||n.push(JsNode.#g(t,e,s))})),Promise.all(n).then((()=>{this.#C(i,o)}))})):this.#d.some((e=>e.isAnimating))?JsNode.#a.push(JsNode.#J(this.show,this,[e,t,s,i])):(this.#d.forEach(((e,t)=>{this.visible(t)||JsNode.#w(e,!0,s)})),JsNode.#a.length&&setTimeout(JsNode.#a.shift())),this}hide(e,t=0,s="all",i){return void 0!==e?this.#d.some((e=>e.isAnimating))?JsNode.#a.push(JsNode.#J(this.hide,this,[e,t,s,i])):new Promise((async o=>{s=s.toLowerCase(),this.#d.forEach(((e,t)=>{this.visible(t)&&(e.isAnimating=!0)})),void 0!==t&&t>0&&await JsNode.#y(t);const n=[];this.#d.forEach(((t,i)=>{this.visible(i)&&n.push(JsNode.#v(t,e,s))})),Promise.all(n).then((()=>{this.#C(i,o)}))})):this.#d.some((e=>e.isAnimating))?JsNode.#a.push(JsNode.#J(this.hide,this,[e,t,s,i])):(this.#d.forEach(((e,t)=>{this.visible(t)&&JsNode.#w(e,!1,s)})),JsNode.#a.length&&setTimeout(JsNode.#a.shift())),this}toggle(e,t=0,s="all",i){return void 0!==e?this.#d.some((e=>e.isAnimating))?JsNode.#a.push(JsNode.#J(this.toggle,this,[e,t,s,i])):new Promise((async o=>{s=s.toLowerCase(),this.#d.forEach((e=>{e.isAnimating=!0})),void 0!==t&&t>0&&await JsNode.#y(t);const n=[];this.#d.forEach(((t,i)=>{this.visible(i)?n.push(JsNode.#v(t,e,s)):n.push(JsNode.#g(t,e,s))})),Promise.all(n).then((()=>{this.#C(i,o)}))})):this.#d.some((e=>e.isAnimating))?JsNode.#a.push(JsNode.#J(this.toggle,this,[e,t,s,i])):(this.#d.forEach(((e,t)=>{JsNode.#w(e,!this.visible(t),s)})),JsNode.#a.length&&setTimeout(JsNode.#a.shift())),this}focus(){for(const e of this.#d)e.focus();return this}click(){for(const e of this.#d)e.click();return this}remove(){for(;this.#d.length;){const e=this.#d.at(-1);JsNode.#h(e),JsNode.#c(e),e.remove(),this.#d.pop()}return this}empty(){for(const e of this.#d)JsNode.select(e.childNodes).remove();let e=0;for(;e<this.#d.length;){const t=this.#d[e];t.isConnected?e++:(t.remove(),this.#d.splice(e,1))}return this}one(e=0){return new JsNode(this.#d.at(e))}on(e,t){for(const s of this.#d){s.listeners||(s.listeners={}),s.listeners[e]||(s.listeners[e]=[]);const i=t.bind(new JsNode(s));s.addEventListener(e,i),s.listeners[e].push(i)}return this}off(e){for(const t of this.#d)e?JsNode.#l(t,e):JsNode.#h(t);return this}width(e){return void 0===e?this.#d[0]?parseFloat(getComputedStyle(this.#d[0]).width):void 0:(JsNode.isNumber(e)&&(e+="px"),this.#d.forEach(((t,s)=>{if("function"!=typeof e)t.style.width=e;else{let i=e(parseFloat(getComputedStyle(t).width),s);JsNode.isNumber(i)&&(i+="px"),t.style.width=i}})),this)}height(e){return void 0===e?this.#d[0]?parseFloat(getComputedStyle(this.#d[0]).height):void 0:(JsNode.isNumber(e)&&(e+="px"),this.#d.forEach(((t,s)=>{if("function"!=typeof e)t.style.height=e;else{let i=e(parseFloat(getComputedStyle(t).height),s);JsNode.isNumber(i)&&(i+="px"),t.style.height=i}})),this)}innerWidth(e){if(void 0!==e)return JsNode.isNumber(e)&&(e+="px"),this.#d.forEach(((t,s)=>{const i=getComputedStyle(t),o=parseFloat(i.paddingLeft)+parseFloat(i.paddingRight);if("function"!=typeof e)t.style.width=e;else{let n=e(parseFloat(i.width)+o,s);JsNode.isNumber(n)&&(n+="px"),t.style.width=n}t.style.width=parseFloat(i.width)-o+"px"})),this;if(this.#d[0]){const e=getComputedStyle(this.#d[0]);return parseFloat(e.width)+parseFloat(e.paddingLeft)+parseFloat(e.paddingRight)}}innerHeight(e){if(void 0!==e)return JsNode.isNumber(e)&&(e+="px"),this.#d.forEach(((t,s)=>{const i=getComputedStyle(t),o=parseFloat(i.paddingTop)+parseFloat(i.paddingBottom);if("function"!=typeof e)t.style.height=e;else{let n=e(parseFloat(i.height)+o,s);JsNode.isNumber(n)&&(n+="px"),t.style.height=n}t.style.height=parseFloat(i.height)-o+"px"})),this;if(this.#d[0]){const e=getComputedStyle(this.#d[0]);return parseFloat(e.height)+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)}}outerWidth(e,t=!1){if(void 0!==e&&"boolean"!=typeof e)return JsNode.isNumber(e)&&(e+="px"),this.#d.forEach(((s,i)=>{const o=getComputedStyle(s),n=parseFloat(o.paddingLeft)+parseFloat(o.paddingRight)+parseFloat(o.borderLeftWidth)+parseFloat(o.borderRightWidth)+(t?parseFloat(o.marginLeft)+parseFloat(o.marginRight):0);if("function"!=typeof e)s.style.width=e;else{let t=e(parseFloat(o.width)+n,i);JsNode.isNumber(t)&&(t+="px"),s.style.width=t}s.style.width=parseFloat(o.width)-n+"px"})),this;if(this.#d[0]){const t=getComputedStyle(this.#d[0]);return parseFloat(t.width)+parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)+parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth)+(e?parseFloat(t.marginLeft)+parseFloat(t.marginRight):0)}}outerHeight(e,t=!1){if(void 0!==e&&"boolean"!=typeof e)return JsNode.isNumber(e)&&(e+="px"),this.#d.forEach(((s,i)=>{const o=getComputedStyle(s),n=parseFloat(o.paddingTop)+parseFloat(o.paddingBottom)+parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth)+(t?parseFloat(o.marginTop)+parseFloat(o.marginBottom):0);if("function"!=typeof e)s.style.height=e;else{let t=e(parseFloat(o.height)+n,i);JsNode.isNumber(t)&&(t+="px"),s.style.height=t}s.style.height=parseFloat(o.height)-n+"px"})),this;if(this.#d[0]){const t=getComputedStyle(this.#d[0]);return parseFloat(t.height)+parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)+parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth)+(e?parseFloat(t.marginTop)+parseFloat(t.marginBottom):0)}}get nodes(){return this.#d}get length(){return this.#d.length}visible(e=0){const t=this.#d[e];if(t){const e=getComputedStyle(t);return"none"!==e.display&&"hidden"!==e.visibility&&"collapse"!==e.visibility}}}